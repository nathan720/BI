# BAR 类型图表全配置指南

本文档详细说明了系统中支持的各种柱状图类型的配置方法和步骤。

## 一、 如何实现“不同项目显示不同颜色”

在 Bar Race（动态条形图）或普通柱状图中，默认情况下同一系列的所有柱子颜色相同。要让每个柱子（即每个项目）显示不同颜色，请按以下步骤操作：

### 1. 设置颜色分组（关键步骤）
*   **位置**: 系列配置 (Series Config) -> 颜色分组 (color_by)
*   **操作**: 将其从默认的 "按系列 (series)" 修改为 **"按数据项 (data)"**。
*   **效果**: 系统会自动从颜色盘中依次为每个柱子分配不同的颜色。

### 2. 自定义颜色序列（可选）
*   **位置**: 全局配置 (Global Config) -> 自定义颜色序列 (colors)
*   **操作**: 输入颜色代码，用英文逗号分隔。
    *   示例: `#5470c6, #91cc75, #fac858, #ee6666`
*   **说明**: 如果不填，系统会自动使用一套美观的默认配色方案。

---

## 二、 图表类型配置详解

### 1. 基础柱状图 (Basic Bar Chart)
最常见的分类对比图。

*   **X轴数据**: 选择维度字段（如 `Project`）。
*   **Y轴数据**: 选择数值字段（如 `Sales`）。
*   **翻转轴 (可选)**: 若需横向条形图，在全局配置中勾选 `reversal_axis`。

### 2. 堆叠柱状图 (Stacked Bar Chart)
用于展示部分与整体的关系。

*   **基础数据**: 配置X轴和Y轴（可选择多个Y轴字段，如 `Sales_A`, `Sales_B`）。
*   **堆叠设置**: 在系列配置中，勾选 **堆叠显示 (stack)**。
*   **堆叠名称**: 确保所有需要堆叠的系列使用相同的堆叠名称（默认 `stack1`）。

### 3. 百分比堆叠柱状图 (100% Stacked Bar)
用于展示各部分占总量的百分比分布。

*   **前置条件**: 完成上述“堆叠柱状图”的所有设置。
*   **堆叠模式**: 在系列配置中，找到 **堆叠模式 (stack_strategy)**，选择 **"百分比堆叠 (percent)"**。
*   **效果**: Y轴会自动转换为 0-100%，并在 Tooltip 中显示百分比。

### 4. Bar Race (动态竞速条形图)
用于展示随时间变化的数据排名动态。

*   **基础设置**: 选择 X轴（项目名）和 Y轴（数值）。
*   **开启竞速**: 在系列配置中，勾选 **实时排序 (realtime_sort)**。
*   **横向显示**: 在全局配置中，勾选 **翻转轴 (reversal_axis)**。
*   **动画配置**:
    *   **更新动画时长**: 建议设置为 `500` - `1000` (毫秒)。
    *   **标签动画**: 勾选 `label_value_animation`。
*   **时间轴配合**: 需配合 Timeline 功能使用（见下文）。

### 5. 带时间轴的动态图 (Timeline Bar)
让图表按时间自动播放。

*   **时间维度**: 在 **时间轴配置** 中，输入时间字段名（如 `dim_time` 或 `year`）。
*   **自动播放**: 勾选 `True`。
*   **播放间隔**: 设置为 `1000` (毫秒) 或根据需要调整。
*   **适用场景**: 此功能可与上述任何图表类型组合使用，最常用于 Bar Race。

---

## 三、 配置速查清单

| 图表类型 | 关键配置项 (Key Settings) | 推荐值 |
| :--- | :--- | :--- |
| **多彩柱状图** | `color_by` (颜色分组) | **data (按数据项)** |
| **横向条形图** | `reversal_axis` (翻转轴) | True |
| **堆叠图** | `stack` (堆叠显示) | True |
| **百分比堆叠** | `stack_strategy` (堆叠模式) | **percent** |
| **动态竞速图** | `realtime_sort` (实时排序) | True |
| **时间轴播放** | `timeline_field` (时间维度) | 您的时间字段名 |

---

## 四、 进阶：其他特殊柱状图

除了上述标准柱状图外，系统还支持以下特殊形态的柱状图：

### 1. 象形柱图 (PictorialBar)
使用图形或图标来代替传统的矩形条，常用于更具视觉冲击力的展示。系统已将其集成到标准柱状图中。

*   **图表类型选择**: 选择 `Bar` (柱状图)。
*   **关键配置 (图形样式)**:
    *   **图形 (symbol)**: 定义柱子的形状。设置此项后，图表将自动切换为象形柱图模式。
        *   常用值: `rect` (矩形), `roundRect` (圆角矩形), `triangle` (三角形), `diamond` (菱形), `pin` (大头针), `arrow` (箭头)。
        *   图片路径: 支持 `image://url` 格式引入自定义图片。
    *   **重复方式 (symbol_repeat)**:
        *   `fixed`: 固定数量重复（适合打分/星级展示）。
        *   `True` (或勾选): 根据数值自动重复图形（适合用图标数量代表数值）。
        *   `False` (默认): 拉伸图形不重复。
    *   **裁剪 (is_symbol_clip)**: 是否裁剪超出部分（通常与 `symbol_repeat` 配合使用）。

### 2. 组合/层叠图 (Overlap Chart)
支持将柱状图与折线图、散点图组合在同一坐标系中。

*   **图表类型选择**: 选择 `Grid` (组合图表) 或 `Overlap` (层叠图表)。
*   **关键配置 (组件配置)**:
    *   **重叠类型 (overlap_type)**: 选择 `bar_line` (柱状+折线)。
*   **数据列配置**:
    *   在数据面板中，可以为不同的数值列指定不同的图表类型（如列A为柱状图，列B为折线图）。
    *   **Y轴索引**: 若需要双Y轴（一左一右），请配置 `series_axis`（在高级数据配置中）。
